---
title: "Análisis AIRBNB"
author: "Grupo 12"
output: 
  html_document:
    toc: true
    toc_depth: 5
    toc_float: 
     collapsed: true
     smooth_scroll: true
---

```{r setup, include=FALSE, purl=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      eval = TRUE, 
                      warning = FALSE,
                      message = FALSE,
                      error = TRUE)
```

## Introducción y definición de objetivos

Durante estos últimos años, plataformas donde se reservan propiedades durante un tiempo determinado, como es Airbnb, han ido subiendo su popularidad, optando mucha gente por este tipo de servicio. Es por ello que un análisis de este modelo de negocio es interesante tanto para los clientes como para la empresa propietaria de Airbnb. Por ello, el principal objetivo de esta investigación es observar como afectan al precio las distintas variables.

Hemos descartado algunas variables dentro de esta base de datos. Comenzamos descartando las variables "latitud", "longitud" y "zipcode", ya que tienen que ver con la localización de la propiedad y eso ya se refleja con las variables "city" y "neighbourhood". Otra variable descartada es "amenities" ya que contenía muchas más variables internas que complicarían el análisis. La variable "accomodates", referida al número de personas que se alojan en la propiedad, decidimos descartarla porque hay otras variables que la hacen redundante. La variable "host_response_rate" (tasa de respuesta del anfitrión) la descartamos ya que en muchos de los casos no hay información. Variables como "first review" (fecha en la que se realizó la primera valoración), "last review" (fecha en la que se realizó la última valoración), "description" (descripción), "host_has_profile_pic" (si el anfitrión tiene foto de perfil en Airbnb), "host_since" (fecha en la que se publicó por primera vez la propiedad), "name" (nombre de la propiedad) o "thumbnail_url" (URL de la página de la propiedad), han sido descartadas porque no son relevantes para nuestro análisis.

## Importación de datos y paquetes usados

```{r message=FALSE, warning=FALSE}
library(dplyr)
library(readr)
library(tidyverse)
library(ggplot2)
library(summarytools)
library(GGally)
library(knitr)
library(ggcorrplot)
library(corrplot)
library(htmltools)

Airbnb_Data <- read_csv("Airbnb_Data.csv")
```

## Diccionario de datos

-   `price` : Precio de la reserva de AIRBNB en dólares.

    -   Tipo: Numérica continua.

-   `property_type`: Tipo de propiedad que se reserva.

    -   Tipo: Categórica multinivel.

-   `room_type`: Tipo de habitación que incluye la reserva.

    -   Tipo: Categórica multinivel.

-   `bathrooms`: Número de baños que contiene la propiedad.

    -   Tipo: Numérica continua.

-   `bedrooms`: Número de habitaciones de la propiedad.

    -   Tipo: Numérica discreta.

-   `beds`: Número de camas de la propiedad.

    -   Tipo: Numérica discreta.

-   `bed_type`: Tipo de cama que ofrece la propiedad.

    -   Tipo: Categórica multinivel.

-   `cancellation_policy`: Tipo de política de cancelación.

    -   Tipo: Categórica ordinal.

-   `cleaning_fee`: Tarifa por limpieza.

    -   Tipo: Categórica dicotómica. (TRUE, hay / FALSE, no hay)

-   `city`: Ciudad de ubicación de la propiedad.

    -   Tipo: Categórica multinivel.

-   `neighbourhood`: Barrio de ubicación de la propiedad.

    -   Tipo: Categórica multinivel.

-   `host_identity_verified`: Anfitrión verificado en Airbnb.

    -   Tipo: Categórica dicotómica. (TRUE, sí / FALSE, no)

-   `instant_bookable`: Reservar la propiedad al instante.

    -   Tipo: Categórica dicotómica. (TRUE, sí / FALSE, no)

-   `number_of_reviews`: Número de reviews de la propiedad.

    -   Tipo: Numérica discreta.

-   `review_scores_rating`: Puntuación de las reviews de la propiedad.

    -   Tipo: Numérica discreta.

## Análisis exploratorio de datos

Comenzamos realizando un estudio de todas las variables de manera univariante.

### Análisis univariante:

#### Estudio de la variable price

Antes de estudiar la variable price, observamos que esta se encuentra de forma logarítmica, por tanto, para verlo todo de manera más clara, simplemente invertimos el logaritmo para obtener precios con más sentido.

```{r CambioPrice}
Airbnb_Data$log_price = exp(Airbnb_Data$log_price)
```

A pesar de haber invertido el logaritmo, en la parte de código seguiremos referenciando esta variable como log_price, sin embargo, en las gráficas aparecerá como price en todo momento. Ahora sí comenzamos con el análisis de price.

CONTAR EL NÚMERO DE RESPUESTAS

```{r NumRespuestasPrice, echo=TRUE}
num_respuestas_PRICE <- length(unique(Airbnb_Data$log_price))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_PRICE)
```

Dada la alta cantidad de respuestas distintas, para poder visualizar todo en una tabla de frecuencias de manera medianamente clara, procedemos a dividir los precios en intervalos de 25.

TABLA DE FRECUENCIAS

Estudiamos las frecuencias relativas y absolutas.

```{r}
intervalos <- seq(0, ceiling(max(Airbnb_Data$log_price)/25) * 25, by = 25)
tabla_frecuencias_price <- Airbnb_Data |> count(log_price) |> mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
 tabla_frecuencias_price <- tabla_frecuencias_price |> mutate(Intervalo = cut(log_price, breaks = intervalos, right = FALSE)) |> group_by(Intervalo) |> summarise (n = sum(n), f = sum(f), N = sum(n), F = sum(f))
 for (i in 2: nrow(tabla_frecuencias_price)) {
   tabla_frecuencias_price$N[i] <- tabla_frecuencias_price$N[i] + tabla_frecuencias_price$N[i-1]
    tabla_frecuencias_price$F[i] <- tabla_frecuencias_price$F[i] + tabla_frecuencias_price$F[i-1]}
 tabla_frecuencias_ordenada1 <- tabla_frecuencias_price |> arrange(Intervalo)
 print(tabla_frecuencias_ordenada1)
```

HISTOGRAMA DE PRECIOS

Ahora realizamos el histograma para verlo mucho más claro.

```{r}
datos <- Airbnb_Data$log_price  
 ggplot(data.frame(x = datos), aes(x = x)) +
     geom_histogram(binwidth = 25, fill = "#F16E79", color = "black", 
                    ) +
  
     labs(title = "Distribución de los precios",
          x = "Price",
          y = "Frecuencia") 
```

Como podemos observar, la mayor parte de los precios se encuentra por debajo de los 300\$, donde se ve una clara curva descendente según el precio va aumentando, llegando hasta un máximo de unos 2000\$.

RESUMEN NUMÉRICO DE LOS PRECIOS

Es necesario realizar también un resumen numérico para poder interpretar mejor el histograma.

```{r ResumenPrice}
Airbnb_Data |> select(log_price) |> descr() |> kable(digits = 2)
```

Igual que hemos visto en el histograma, el resumen numérico nos demuestra que la mayor parte de los precios se concentran entre 1\$ y los 185\$, con una media de 160.37\$ y una mediana de 111\$. El precio mínimo es de 1\$ y el máximo es de 1999\$, aunque en muy pocos casos se dan estos valores.

#### Estudio de la variable property_type

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_TYPE <- length(unique(Airbnb_Data$property_type))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_TYPE)
```

Como podemos observar, aquí sí tiene sentido realizar un estudio para poder ver el tipo de casa que más se oferta.

TABLA DE FRECUENCIAS

Ahora estudiaremos las frecuencias relativas y absolutas.

```{r}
tabla_frecuencias_type <- Airbnb_Data |>
     count(property_type) |>
    mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))

tabla_frecuencias_ordenada2 <- tabla_frecuencias_type |>
    arrange(desc(n))

tabla_frecuencias_ordenada2$F <- cumsum(tabla_frecuencias_ordenada2$f)

tabla_frecuencias_ordenada2$N <- cumsum(tabla_frecuencias_ordenada2$n)

print(tabla_frecuencias_ordenada2)
```

GRÁFICO DE BARRAS CON FRECUENCIA RELATIVA DE PROPERTY_TYPE

Para poder observar con mayor claridad los datos en función de la frecuencia relativa realizaremos una gráfica.

```{r}
Airbnb_Data |> group_by(property_type) |> summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), property_type = reorder(property_type, -Frequency)) |> ggplot(aes(x = property_type, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de property_type", x = "Tipo de casa", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

De la misma forma realizaremos una gráfica con los datos en función de la frecuencia absoluta.

GRÁFICO DE BARRAS CON FRECUENCIA ABSOLUTA DE PROPERTY_TYPE

```{r}
Airbnb_Data |>
     group_by(property_type) |>
     summarise(Frequency = n()) |>
     mutate(property_type = reorder(property_type, -Frequency)) |>
    ggplot(aes(x = property_type, y = Frequency)) +
     geom_bar(stat = "identity", aes(fill = Frequency)) +
     theme_bw() +
     labs(title = "Gráfico de barras con frecuencia absoluta de property_type",
          x = "Tipo de casa",
          y = "Frecuencia absoluta") +
     scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Aunque hay gran variedad de tipos de propiedades, se observa claramente que la mayor parte de las ofertas son de apartamentos, con un 66,1% del total, seguido de las casas particulares con un 22,3% y ya con mucha diferencia están los condominios con un 3,59%. El resto de tipos de propiedades suman entre sí un 5,7%.

#### Estudio de la variable room_type

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_TYPE <- length(unique(Airbnb_Data$room_type))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_TYPE)
```

Vamos a realizar el estudio para ver cuales son los tipos de habitaciones que más se ofertan en la plataforma.

TABLA DE FRECUENCIAS

Primero estudiaremos las frecuencias relativas y absolutas

```{r}
tabla_frecuencias_type <- Airbnb_Data |>
     count(room_type) |>
    mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
 tabla_frecuencias_ordenada3 <- tabla_frecuencias_type |>
    arrange(desc(n))
 tabla_frecuencias_ordenada3$F <- cumsum(tabla_frecuencias_ordenada3$f)
 tabla_frecuencias_ordenada3$N <- cumsum(tabla_frecuencias_ordenada3$n)
 print(tabla_frecuencias_ordenada3)
```

GRÁFICO DE BARRAS CON FRECUENCIA RELATIVA DE ROOM_TYPE

Para poder observar con mayor claridad los datos en función de la frecuencia relativa realizaremos una gráfica.

```{r}
Airbnb_Data  |> group_by(room_type) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), room_type = reorder(room_type, -Frequency)) |> ggplot(aes(x = room_type, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de room_type", x = "Tipo de habitación", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRÁFICO DE BARRAS CON FRECUENCIA ABSOLUTA DE ROOM_TYPE

De la misma forma realizaremos una gráfica con los datos en función de la frecuencia absoluta.

```{r}
Airbnb_Data  |> group_by(room_type) |>  summarise(Frequency = n()) |> mutate(room_type = reorder(room_type, -Frequency)) |> ggplot(aes(x = room_type, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia absoluta de room_type", x = "Tipo de habitación", y = "Frecuencia absoluta") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Estas gráficas nos muestran que la mayoría de ofertas nos ofrecen la totalidad de la propiedad que alquilamos, con más del 50%, seguidas por las ofertas que de una habitación privada, con un poco más del 40% del total, mientras que las habitaciones compartidas son una minoría con un 5% del total de ofertas.

#### Estudio de la variable bathrooms

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_Bathrooms <- length(unique(Airbnb_Data$bathrooms))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_Bathrooms)

```

Aquí vamos a realizar un estudio para poder ver el número de baños que más se ofertan en la plataforma.

TABLA DE FRECUENCIAS

Estudiamos las frecuencias relativas y absolutas.

```{r}
tabla_frecuencias_bathrooms <- Airbnb_Data |> count(bathrooms) |> drop_na() |> mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f)) 
tabla_frecuencias_ordenada4 <- tabla_frecuencias_bathrooms |>
    arrange(desc(n))
 tabla_frecuencias_ordenada4$F <- cumsum(tabla_frecuencias_ordenada4$f)
 tabla_frecuencias_ordenada4$N <- cumsum(tabla_frecuencias_ordenada4$n)
 print(tabla_frecuencias_ordenada4)
```

HISTOGRAMA DEL NÚMERO DE BAÑOS

Vamos a realizar un histograma con el número de baños que se ofertan.

```{r}
datos <- Airbnb_Data$bathrooms  
 ggplot(data.frame(x = datos), aes(x = x)) +
     geom_histogram(binwidth = 0.5, fill = "#F16E79", color = "black", 
                    ) +
  
     labs(title = "Distribución del número de baños",
          x = "Número de baños",
          y = "Frecuencia") 
```

Observamos una clara predominancia de propiedades con un solo baño, siendo también un tanto notables las propiedades con 1.5 y 2 baños. Hay casas con hasta 8 baños, pero es mísera la cantidad de propiedades que se venden con 4 o más de estos. También es sorprendente observar que, por pocas que sean, se oferten casas con 0 baños.

RESUMEN NUMÉRICO DEL NÚMERO DE BAÑOS

También vamos a realizar el resumen numérico que nos ayude a comprender mejor el gráfico.

```{r}
Airbnb_Data |> select(bathrooms) |> descr() |> kable(digits = 2)
```

Podemos observar que se usan decimales para hablar del número de baños, esto se debe a que para poder considerar un baño completo, este tiene que tener un lavabo, un inodoro, una ducha o bañera y un mueble de almacenamiento. El gráfico nos permite ver que la mayoría de ofertas solo tiene un baño, el mínimo de baños es 0 y el máximo son 8, y la media de baños que se ofertan son 1.25 baños.

#### Estudio de la variable bedrooms

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_bedrooms <- length(unique(Airbnb_Data$bedrooms))
cat("El número de respuestas obtenido es: ", num_respuestas_bedrooms)
```

Vamos a realizar un estudio para ver las casas que se ofertan según el número de habitaciones.

TABLA DE FRECUENCIAS

Estudiamos las frecuencias relativas y absolutas.

```{r}
tabla_frecuencias_bedrooms <- Airbnb_Data |> count(bedrooms) |> drop_na() |> mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f)) 
tabla_frecuencias_ordenada5 <- tabla_frecuencias_bedrooms |>
    arrange(desc(n))
 tabla_frecuencias_ordenada5$F <- cumsum(tabla_frecuencias_ordenada5$f)
 tabla_frecuencias_ordenada5$N <- cumsum(tabla_frecuencias_ordenada5$n)
 print(tabla_frecuencias_ordenada5)
```

HISTOGRAMA DEL NÚMERO DE HABITACIONES

Realizamos un histograma para verlo claramente.

```{r}
datos <- Airbnb_Data$bedrooms  
 ggplot(data.frame(x = datos), aes(x = x)) +
     geom_histogram(binwidth = 1, fill = "#F16E79", color = "black", 
                    ) +
  
     labs(title = "Distribución del Número de Habitaciones",
          x = "Número de Habitaciones",
          y = "Frecuencia") 
```

Observamos una destacable mayoría en la oferta de propiedades con una sola habitación. Muy por detrás se encuentran las propiedades con 2 habitaciones, seguidas de casas con 0 habitaciones, cosa que puede llegar a sorprender, sin embargo, ahora analizaremos el número de camas para ver que, aunque haya varias propiedades sin habitaciones, no significa que no tengan cama.

RESUMEN NUMÉRICO DEL NÚMERO DE HABITACIONES

```{r}
Airbnb_Data |> select(bedrooms) |> descr() |> kable(digits = 2) 
```

Visto lo visto, comprobamos que la media está en 1.27, y la mediana en 1, pues la mayor parte de las propiedades tienen una habitación. Cabe destacar que el máximo se encuentra en hasta 10 habitaciones, valor sorprendente pero muy atípico, además de destacar ese mínimo en 0 que si que se da en bastantes casos.

#### Estudio de la variable beds

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_BEDS <- length(unique(Airbnb_Data$beds))     
cat("La cantidad de respuestas obtenidas es:", num_respuestas_BEDS)
```

TABLA DE FRECUENCIAS

Estudiamos las frecuencias relativas y absolutas.

```{r}
tabla_frecuencias_beds <- Airbnb_Data |> count(beds) |> drop_na() |> mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f)) 
tabla_frecuencias_ordenada6 <- tabla_frecuencias_beds |>
    arrange(desc(n))
 tabla_frecuencias_ordenada6$F <- cumsum(tabla_frecuencias_ordenada6$f)
 tabla_frecuencias_ordenada6$N <- cumsum(tabla_frecuencias_ordenada6$n)
 print(tabla_frecuencias_ordenada6)
```

HISTOGRAMA DEL NÚMERO DE CAMAS

Realizamos aquí un histograma para verlo más claro.

```{r}
datos <- Airbnb_Data$beds  
 ggplot(data.frame(x = datos), aes(x = x)) +
     geom_histogram(binwidth = 1, fill = "#F16E79", color = "black", 
                    ) +
  
     labs(title = "Distribución del Número de Camas",
          x = "Número de camas",
          y = "Frecuencia") 
```

Aquí se ve que predomina enormemente la oferta de propiedades con una sola cama, seguido de las que tienen 2 camas, siendo menos de la mitad de las de una cama, y así sucesivamente según aumenta el número de camas.

ANÁLISIS NUMÉRICO

```{r}
Airbnb_Data |> select(beds) |> descr() |> kable(digits = 2)
```

Llama la atención que el mínimo sea 0, es decir, que se oferten casas sin cama, sin embargo, este dato es muy atípico y es muy poco apreciable el porcentaje de propiedades con 0 camas, al igual que el máximo, que está en 18 camas. Tras ello observamos que la media está en 1.71 camas y la mediana en 1, el valor predominante.

#### Estudio de la variable bed_type

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_bed_type <- length(unique(Airbnb_Data$bed_type))
cat("El número de respuestas obtenido es: ", num_respuestas_bed_type)
```

Aquí estudiaremos cuales son los tipos de camas que más se ofertan.

TABLA DE FRECUENCIAS

Primero estudiaremos las frecuencias relativas y absolutas.

```{r}
tabla_frec_bed_type <- Airbnb_Data |> count(bed_type) |> mutate (f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_5 <- tabla_frec_bed_type |> arrange(desc(n)) 
tabla_frec_ord_5$N <- cumsum(tabla_frec_ord_5$n)
tabla_frec_ord_5$F <- cumsum(tabla_frec_ord_5$f) 
print(tabla_frec_ord_5)
```

GRÁFICO DE BARRAS CON FRECUENCIA RELATIVA

Para poder observar los datos en función de frecuencia relativa con mayor claridad realizaremos una gráfica.

```{r}
Airbnb_Data  |> group_by(bed_type) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), bed_type = reorder(bed_type, -Frequency)) |> ggplot(aes(x = bed_type, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de bed_type", x = "Tipo de cama", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRÁFICO DE BARRAS CON FRECUENCIA ABSOLUTA

De la misma forma realizaremos un gráfico con las frecuencias absolutas.

```{r}
Airbnb_Data  |> group_by(bed_type) |>  summarise(Frequency = n()) |> mutate(bed_type = reorder(bed_type, -Frequency)) |> ggplot(aes(x = bed_type, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia absoluta de bed_type", x = "Tipo de cama", y = "Frecuencia absoluta") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

Como podemos observar en los gráficos, casi el 100% de las camas son camas normales, y son muy pocas las ofertas que tiene algún otro tipo de cama.

#### Estudio de la variable cancellation_policy

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_cancellation_policy <- length(unique(Airbnb_Data$cancellation_policy)) 
cat("El número de respuestas es: ", num_respuestas_cancellation_policy)
```

Aquí vamos a estudiar cuales son las políticas de cancelación más presentes en la plataforma.

TABLA DE FRECUENCIAS

Primero estudiaremos las frecuencias relativas y absolutas.

```{r}
tabla_frecuencias_cancellation_policy <- Airbnb_Data |> count(cancellation_policy) |> drop_na() |> mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f)) 
tabla_frecuencias_ordenada6 <- tabla_frecuencias_cancellation_policy |>
    arrange(desc(n))
 tabla_frecuencias_ordenada6$F <- cumsum(tabla_frecuencias_ordenada6$f)
 tabla_frecuencias_ordenada6$N <- cumsum(tabla_frecuencias_ordenada6$n)
 print(tabla_frecuencias_ordenada6)
```

GRÁFICO DE BARRAS CON FRECUENCIA RELATIVA

Para ello vamos a realizar un gráfico para poder entender mejor los datos en función de frecuencia relativa.

```{r}
Airbnb_Data  |> group_by(cancellation_policy) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), cancellation_policy = reorder(cancellation_policy, -Frequency)) |> ggplot(aes(x = cancellation_policy, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de cancellation_policy", x = "Política de cancelación", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRÁFICO DE BARRAS CON FRECUENCIA ABSOLUTA

De la misma forma vamos a realizar un gráfico con las frecuencias absolutas de las políticas de cancelación.

```{r}
Airbnb_Data  |> group_by(cancellation_policy) |>  summarise(Frequency = n()) |> mutate(cancellation_policy = reorder(cancellation_policy, -Frequency)) |> ggplot(aes(x = cancellation_policy, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia absoluta de cancellation_policy", x = "Política de cancelación", y = "Frecuencia absoluta") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Estos gráficos nos muestran que la mayoría de los ofertantes son estrictos en cuanto a su política de cancelación, con alrededor del 44% del total de datos, de cerca les siguen los ofertantes con una política flexible y moderada con un 30% y 26% respectivamente, y con mucha diferencia se encuentran el resto de políticas.

#### Estudio de la variable cleaning_fee

Vamos a estudiar la variable cleaning_fee.

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_cleaning_fee <- length(unique(Airbnb_Data$cleaning_fee))
cat("El número de respuestas obtenido es: ", num_respuestas_cleaning_fee)
```

TABLA DE FRECUENCIAS

Para ello estudiamos las frecuencias relativas y absolutas.

```{r}
tabla_frec_cleaning_fee <- Airbnb_Data |> count(cleaning_fee) |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_7 <- tabla_frec_cleaning_fee |> arrange(desc(n)) 
tabla_frec_ord_7$N <- cumsum(tabla_frec_ord_7$n)
tabla_frec_ord_7$F <- cumsum(tabla_frec_ord_7$f) 
print(tabla_frec_ord_7)
```

GRÁFICO DE BARRAS CON FRECUENCIA RELATIVA

Para entender mejor los datos vamos a realizar un gráfico de barras con frecuencia relativa de esta variable.

```{r}
Airbnb_Data  |> group_by(cleaning_fee) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), cleaning_fee = reorder(cleaning_fee, -Frequency)) |> ggplot(aes(x = cleaning_fee, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de cleaning_fee", x = "Impuesto de Limpieza", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRÁFICO DE BARRAS CON FRECUENCIA ABSOLUTA

Del mismo modo vamos a realizar otro gráfico de barras, pero esta vez de frecuencia absoluta.

```{r}
Airbnb_Data  |> group_by(cleaning_fee) |>  summarise(Frequency = n()) |> mutate(cleaning_fee = reorder(cleaning_fee, -Frequency)) |> ggplot(aes(x = cleaning_fee, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia absoluta de cleaning_fee", x = "Impuesto de Limpieza", y = "Frecuencia absoluta") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Al ser una variable categórica dicotómica solo pueden aparecer dos resultados, verdadero o falso. Podemos ver que hay más del doble de propiedades ofertadas con impuesto de limpieza que sin él.

#### Estudio de la variable city

Ahora vamos a analizar la variable city.

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_city <- length(unique(Airbnb_Data$city))
cat("El número de respuestas obtenido es: ", num_respuestas_city)
```

TABLA DE FRECUENCIAS

Analizaremos las frecuencias relativas y absolutas.

```{r}
tabla_frec_city <- Airbnb_Data |> count(city) |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_8 <- tabla_frec_city |> arrange(desc(n)) 
tabla_frec_ord_8$N <- cumsum(tabla_frec_ord_8$n)
tabla_frec_ord_8$F <- cumsum(tabla_frec_ord_8$f) 
print(tabla_frec_ord_8)
```

GRÁFICO DE BARRAS CON FRECUENCIA RELATIVA

Para entender mejor los datos vamos a realizar un gráfico de barras con frecuencia relativa.

```{r}
Airbnb_Data  |> group_by(city) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), city = reorder(city, -Frequency)) |> ggplot(aes(x = city, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de city", x = "Ciudades", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRÁFICO DE BARRAS CON FRECUENCIA ABSOLUTA

Ahora realizaremos un gráfico de barras con frecuencia absoluta.

```{r}
Airbnb_Data  |> group_by(city) |>  summarise(Frequency = n()) |> mutate(city = reorder(city, -Frequency)) |> ggplot(aes(x = city, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia absoluta de city", x = "Ciudades", y = "Frecuencia absoluta") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Podemos ver que la mayor cantidad de ofertas se encuentran en Nueva York, siguiéndola medianamente de cerca Los Ángeles. Bastante por debajo se encuentran las demás cuidades, siendo por poco Boston donde hay la menor cantidad de ofertas.

#### Estudio de la variable host_identity_verified

Ahora analizaremos la variable host_identity_verified.

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_host_identity_verified <- length(unique(Airbnb_Data$host_identity_verified))
cat("El número de respuestas obtenido es: ", num_respuestas_host_identity_verified)
```

FRECUENCIAS RELATIVAS Y ABSOLUTAS

Para hacer el análisis de esta variable vamos a estudiar su frecuencia relativa y absoluta.

```{r}
tabla_frec_host_identity_verified <- Airbnb_Data |> count(Airbnb_Data$host_identity_verified) |> drop_na() |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_9 <- tabla_frec_host_identity_verified |> arrange(desc(n)) 
tabla_frec_ord_9$N <- cumsum(tabla_frec_ord_9$n)
tabla_frec_ord_9$F <- cumsum(tabla_frec_ord_9$f) 
print(tabla_frec_ord_9)
```

GRÁFICO DE BARRAS CON FRECUENCIA RELATIVA

Vamos a hacer un gráfico de barras con los datos en función de su frecuencia relativa para visualizarlos mejor.

```{r}
Airbnb_Data  |> group_by(host_identity_verified) |>  summarise(Frequency = n()) |> drop_na() |> mutate(Frequency = Frequency/sum(Frequency), host_identity_verified = reorder(host_identity_verified, -Frequency)) |> ggplot(aes(x = host_identity_verified, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de host_identity_verified", x = "¿Está verificado?", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRÁFICO DE BARRAS CON FRECUENCIA ABSOLUTA

Del mismo modo haremos otro gráfico con los datos en frecuencia absoluta.

```{r}
Airbnb_Data  |> group_by(host_identity_verified) |>  summarise(Frequency = n()) |> drop_na() |> mutate(host_identity_verified = reorder(host_identity_verified, -Frequency)) |> ggplot(aes(x = host_identity_verified, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia absoluta de host_identity_verified", x = "Identidad verfificada", y = "Frecuencia absoluta") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Vemos que aproximadamente el 66% de los anfitriones si tienen su identidad verificada.

#### Estudio de la variable instant_bookable

A continuación vamos a realizar el estudio de la variable instant_bookable.

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_instant_bookable <- length(unique(Airbnb_Data$instant_bookable))
cat("El número de respuestas obtenido es: ", num_respuestas_instant_bookable)
```

TABLA DE FRECUENCIAS

Realizamos el estudio de su frecuencia relativa y absoluta.

```{r}
tabla_frec_instant_bookable <- Airbnb_Data |> count(Airbnb_Data$instant_bookable) |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_10 <- tabla_frec_instant_bookable |> arrange(desc(n)) 
tabla_frec_ord_10$N <- cumsum(tabla_frec_ord_10$n)
tabla_frec_ord_10$F <- cumsum(tabla_frec_ord_10$f) 
print(tabla_frec_ord_10)
```

GRÁFICO DE BARRAS CON FRECUENCIA RELATIVA

Para interpretar mejor los datos vamos a hacer un gráfico de barras en función de su frecuencia relativa.

```{r}
Airbnb_Data  |> group_by(instant_bookable) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), instant_bookable = reorder(instant_bookable, -Frequency)) |> ggplot(aes(x = instant_bookable, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de instant_bookable", x = "¿Se puede reservar al instante?", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRÁFICO DE BARRAS CON FRECUENCIA ABSOLUTA

Y otro gráfico en función de su frecuencia absoluta.

```{r}
Airbnb_Data  |> group_by(instant_bookable) |>  summarise(Frequency = n()) |> mutate(instant_bookable = reorder(instant_bookable, -Frequency)) |> ggplot(aes(x = instant_bookable, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia absoluta de instant_bookable", x = "Reserva instantánea", y = "Frecuencia absoluta") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

De igual manera vemos como solo cerca de un 25% de las ofertas se pueden reservar al instante.

#### Estudio de la variable neighbourhood

A continuación, vamos a estudiar la variable neighbourhood.

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_neighbourhood <- length(unique(Airbnb_Data$neighbourhood))
cat("El número de respuestas obtenido es: ", num_respuestas_neighbourhood)
```

Al ver que el número de respuestas es muy elevado, el análisis no nos va a resultar muy útil.

TABLA DE FRECUENCIAS

```{r}
tabla_frec_neighbourhood <- Airbnb_Data |> count(Airbnb_Data$neighbourhood) |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_11 <- tabla_frec_neighbourhood |> arrange(desc(n)) 
tabla_frec_ord_11$N <- cumsum(tabla_frec_ord_11$n)
tabla_frec_ord_11$F <- cumsum(tabla_frec_ord_11$f) 
print(tabla_frec_ord_11)
```

Vamos a realizar un gráfico de barras con frecuencia relativa.

GRÁFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(neighbourhood) |>  summarise(Frequency = n())  |>  mutate(Frequency = Frequency/sum(Frequency), neighbourhood = reorder(neighbourhood, -Frequency)) |> ggplot(aes(x = neighbourhood, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de neighbourhood", x = "Barrio", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Del mismo modo hacemos otro gráfico de barras con la frecuencia absoluta.

GRÁFICO DE BARRAS CON FRECUENCIA ABSOLUTA

```{r}
Airbnb_Data  |> group_by(neighbourhood) |>  summarise(Frequency = n()) |>  mutate(neighbourhood = reorder(neighbourhood, -Frequency)) |> ggplot(aes(x = neighbourhood, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia absoluta de neighbourhood", x = "Barrios", y = "Frecuencia absoluta") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Como podemos observar hay tantos datos que el análisis es ilegible y además llega un momento que la información se pierde, por lo que hemos decidido hacer otras dos gráficas con solo los barrios que cuentan con más de 300 ofertas en la plataforma.

GRÁFICO DE BARRAS CON FRECUENCIA RELATIVA DE LOS BARRIOS CON MÁS DE 300 OFERTAS

```{r}
Airbnb_Data  |> group_by(neighbourhood) |>  summarise(Frequency = n())  |>  drop_na() |> filter(Frequency > 300)|>mutate(Frequency = Frequency/sum(Frequency), neighbourhood = reorder(neighbourhood, -Frequency)) |> ggplot(aes(x = neighbourhood, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de barrios con más de 300 ofertas ", x = "Barrio", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 60, hjust = 1)) 
```

GRÁFICO DE BARRAS CON FRECUENCIA ABSOLUTA DE LOS BARRIOS CON MÁS DE 300 OFERTAS

```{r}
Airbnb_Data  |> group_by(neighbourhood) |>  summarise(Frequency = n()) |> drop_na() |> filter(Frequency > 300)|> mutate(neighbourhood = reorder(neighbourhood, -Frequency)) |> ggplot(aes(x = neighbourhood, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia absoluta de barrios con más de 3000 ofertas", x = "Barrios", y = "Frecuencia absoluta") + scale_fill_gradient("Frecuencia", low = "#F16E79", high = "#CB0019") + theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

Después de analizar solo los barrios con más de 300 ofertas, vemos que la mayor parte de estas se encuentran en Williamsburg (Nueva York) con un 3.9 % del total, sumando casi 3000 ofertas, seguido de Bedford-Stuyvesant (Nueva York), con más de 2000 ofertas y de Bushwick (Nueva York), superando las 1500 ofertas. Con todo ello se puede observar que los 3 barrios con más ofertas se encuentra en Nueva York.

#### Estudio de la variable number_of_reviews

Aquí vamos a realizar el estudio de la variable number_of_reviews

CONTAR EL NÚMERO DE RESPUESTAS

```{r NumRespuestasnumber_of_reviews, echo=TRUE}
num_respuestas_number_of_reviews <- length(unique(Airbnb_Data$number_of_reviews))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_number_of_reviews)
```

TABLA DE FRECUENCIAS

Estudiamos las frecuencias relativas y absolutas con la tabla de frecuencias, dividiendo los valores en rangos de 20 por la gran cantidad de respuestas que hay en esta variable.

```{r}
intervalos <- seq(0, ceiling(max(Airbnb_Data$number_of_reviews)/20) * 20, by = 20)
tabla_frecuencias_number_of_reviews <- Airbnb_Data |> count(number_of_reviews) |> drop_na() |> mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
 tabla_frecuencias_number_of_reviews <- tabla_frecuencias_number_of_reviews |> mutate(Intervalo = cut(number_of_reviews, breaks = intervalos, right = FALSE)) |> group_by(Intervalo) |> summarise (n = sum(n), f = sum(f), N = sum(n), F = sum(f))
 for (i in 2: nrow(tabla_frecuencias_number_of_reviews)) {
   tabla_frecuencias_number_of_reviews$N[i] <- tabla_frecuencias_number_of_reviews$N[i] + tabla_frecuencias_number_of_reviews$N[i-1]
    tabla_frecuencias_number_of_reviews$F[i] <- tabla_frecuencias_number_of_reviews$F[i] + tabla_frecuencias_number_of_reviews$F[i-1]}
 tabla_frecuencias_ordenada12 <- tabla_frecuencias_number_of_reviews |> arrange(Intervalo)
 print(tabla_frecuencias_ordenada12)
```

HISTOGRAMA DE NÚMERO DE REVIEWS

Para poder interpretar bien los datos vamos a hacer un histograma y un análisis numérico.

```{r}
datos <- Airbnb_Data$number_of_reviews  
 ggplot(data.frame(x = datos), aes(x = x)) +
     geom_histogram(binwidth = 20, fill = "#F16E79", color = "black", 
                    ) +
  
     labs(title = "Distribución del número de reseñas",
          x = "Número de reseñas",
          y = "Frecuencia") 
```

En este histograma, se puede ver que la gran mayoría de propiedades ofertadas cuentan con entre 0 y 20 reseñas. Las propidades con más de 20 reviews conforman un número total de unas 30000 ofertas, lo cual supone menos de la mitad de las ofertas totales.

RESUMEN NUMÉRICO DEL NÚMERO DE REVIEWS

```{r Resumennumber_of_reviews}
Airbnb_Data |> select(number_of_reviews) |> descr() |> kable(digits = 2)

```

Se puede observar que hay bastantes pocos casos en los que se muestran más de 100 reseñas, siendo así que la media de reviews por propiedad es de casi 21. Sin embargo, hay propiedades con entre 0 y 605 reseñas.

#### Estudio de la variable review_scores_rating

A continuación, vamos a analizar la variable review_score_rating.

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_review_scores_rating <- length(unique (Airbnb_Data$review_scores_rating))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_review_scores_rating)
```

TABLA DE FRECUENCIAS

Estudiamos las frecuencias relativas y absolutas.

```{r}
tabla_frecuencias_review_scores_rating <- Airbnb_Data |> drop_na() |>count(review_scores_rating) |> mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f)) 
tabla_frecuencias_ordenada13 <- tabla_frecuencias_review_scores_rating |>
    arrange(desc(n))
 tabla_frecuencias_ordenada13$F <- cumsum(tabla_frecuencias_ordenada5$f)
 tabla_frecuencias_ordenada13$N <- cumsum(tabla_frecuencias_ordenada5$n)
 print(tabla_frecuencias_ordenada13)
```

HISTOGRAMA DE LA PUNTUACIÓN DE REVIEWS

Primero vamos a hacer un histograma de los datos para poder visualizarlos mejor.

```{r}
datos <- Airbnb_Data$review_scores_rating  
 ggplot(data.frame(x = datos), aes(x = x)) +
     geom_histogram(binwidth = 1, fill = "#F16E79", color = "black", 
                    ) +
  
     labs(title = "Distribución de la Puntuación de reviews",
          x = "Puntuación de reviews",
          y = "Frecuencia") 
```

Se puede ver como las propiedades con puntuaciones de entre 90 y 100 predominan, además de que las que tiene una valoración por debajo de 80 son despreciables.

RESUMEN NUMÉRICO DE LA PUNTUACIÓN DE REVIEWS

Y después hacemos un análisis numérico.

```{r}
Airbnb_Data |> select(review_scores_rating) |> descr() |> kable(digits = 2)
```

Después de analizar la variable, al haber visto que la gran mayoría de puntuaciones son altas, la media está en torno a 94 y la mediana es de 96. Aunque también se ve que la puntación no baja nunca de 20.

### Análisis bivariante:

#### Estudio de las variables bedrooms, bathrooms, price y beds

En primer lugar, vamos a realizar un estudio de la correlación y la covarianza entre las variables bedrooms, bathrooms, price y beds, proporcionando una visión de cómo varían conjuntamente las variables.

MATRIZ DE CORRELACIÓN

```{r}
Airbnb_Data |> select(bedrooms, bathrooms, log_price, beds) |> 
    drop_na() |>  
    cor() |> 
    round(2)
```

MATRIZ DE COVARIANZA

```{r}
Airbnb_Data |> select(bedrooms, bathrooms, log_price, beds) |> 
    drop_na() |>  
    cov() |> 
    round(2)
```

Ahora realizaremos un gráfico con los datos ya mostrados para poder entenderlos mejor.

GRÁFICO DE CORRELACIÓN NUMÉRICA

```{r}
Airbnb_Data |> 
    select(bedrooms, bathrooms, log_price, beds) |>
    drop_na() |> 
    cor() |> 
    round(2) |>
    corrplot(method = "ellipse",  type = "lower",      addCoef.col = "white", diag = FALSE)
```

Podemos observar que la correlación entre el precio y el resto de variables no es tan elevado por la gran cantidad de valores atípicos que posee nuestra base de datos, sin embargo, es suficiente como para estudiar la relación. Podemos observar como hay una mayor correlación entre el número de habitaciones y el número de baños, y sobre todo entre el número de habitaciones y el número de camas como es lógico. La relación entre el número de habitaciones y el de camas, nos ayuda a ver que cuantas más habitaciones, más personas pueden alojarse en la casa, ya que aumenta también el número de camas y no suelen ser habitaciones "vacías".

#### Estudio de las variables bedrooms y price

Para llevar a cabo este estudio, primero realizamos dos tablas de contingencia, una relativa y otra absoluta.

TABLA DE CONTINGENCIA ENTRE LAS VARIABLES BEDROOMS Y PRICE RELATIVA

```{r eval=FALSE, include=FALSE}
kable(table(Airbnb_Data$log_price, Airbnb_Data$bedrooms))
```

No mostramos la tabla porque la abundancia de datos hace que sea inmensamente grande, pero hacemos un gráfico de dispersión de regresión lineal.

GRÁFICO DE DISPERSIÓN CON AJUSTE DE REGRESIÓN LINEAL

```{r}
Airbnb_Data |> 
    ggplot(aes(x = bedrooms, y = log_price)) +
    geom_point() +
    geom_smooth(method = lm) +
    labs(title = "Gráfico de dispersión con ajuste de regresión lineal")
```

Podemos ver en la gráfica que hay un aumento general del precio de la propiedad según las habitaciones que haya. No obstante, hay una abundancia de datos atípicos hacen un tanto confuso el gráfico, pero aun así se puede identificar de manera correcta el aumento del precio de la propiedad a la par que las habitaciones. No obstante vamos a realizar unos cálculos que nos serán de utilidad para compender mejor la realción.

```{r}
lineal_1 <- Airbnb_Data |> drop_na() |>
  select(bedrooms, log_price) |> 
  with(lm(bedrooms ~ log_price))  
summary(lineal_1)
```

Con estos resultados corroboramos que la abrumadora cantidad de respuestas variadas en cuanto al precio, los datos erróneos son un tanto altos. Esto no quita que exista cierta correlación entre ambas variables, la variable habitaciones explica un 30,29% del precio.

#### Estudio de las variables bedrooms y bathrooms

Para llevar a cabo este estudio primero realizamos dos tablas de contingencia, una relativa y otra absoluta.

TABLA DE CONTINGENCIA ENTRE BEDROOMS Y BATHROOMS RELATIVA

```{r}
kable(prop.table(table(Airbnb_Data$bedrooms, Airbnb_Data$bathrooms)), digits = 6)
```

TABLA DE CONTINGENCIA ENTRE BEDROOMS Y BATHROOMS ABSOLUTA

```{r}
kable(table(Airbnb_Data$bedrooms, Airbnb_Data$bathrooms))
```

Y en segundo lugar vamos a hacer un gráfico de dispersión con ajuste de regresión lineal con los datos obtenidos

```{r}
Airbnb_Data |> 
    ggplot(aes(x = bathrooms, y = bedrooms)) +
    geom_point() +
    geom_smooth(method = lm) +
    labs(title = "Gráfico de dispersión con ajuste de regresión lineal")
```

También hemos realizado los siguientes cálculos que nos aportan información útil para el análisis.

```{r}
lineal_1 <- Airbnb_Data |> drop_na() |>
  select(bedrooms, bathrooms) |> 
  with(lm(bedrooms ~ bathrooms))  
summary(lineal_1)
```

Como podemos ver, la gráfica posee una regresión lineal esperable, a cuantas más habitaciones haya, mayor es el número de baños, a pesar de la gran cantidad de valores atípicos que hay.

Hablando de datos erróneos, estos son una minoría en comparación con la gran mayoría de valores presentes.

Haciendo mención a la ecuación lineal, podemos saber cuales son los valores de los parámetros a y b (0.278301 y 0.8016). Resultando finalmente de esta forma: bathroom= 0.278301+ 0.8016 bedrooms.

Por último, vemos que la variable bedrooms explica el 27,9% de la variabilidad de bathroom, lo cual no nos resulta muy útil ya que entonces el resultado obtenido en el estudio no es muy fiable ya que no es un valor muy elevado.

Aun así, debido al aumento de habitaciones respecto a los baños, podemos deducir que cuantos más baños/habitaciones haya, más grande será la propiedad. Con esto, y habiendo visto anteriormente que la variable del precio aumenta según sube la cantidad de habitaciones, podemos deducir por lógica que el precio también aumenta según el tamaño de la propiedad. Esto significa que, gracias a haber comparado anteriormente las habitaciones y el número de camas, cuantas más personas se puedan alojar, mayor será el precio de la propiedad.

#### Estudio de las variables price y city

HISTOGRAMA DE PRECIO POR CIUDAD

```{r}
Airbnb_Data |> 
  ggplot(aes(x = city, y = log_price)) +  
  geom_boxplot() +  
  theme_bw() +  
  labs(title = "Precio por Ciudad")  
```

Gracias a este gráfico vemos que todas las ciudades presentan muchos valores atípicos, llegando hasta los 2000\$, salvo Boston y Chicago que tiene menos que el resto, llegando a los 1500\$, por lo tanto para poder estudiar mejor estas variables vamos a realizar otro box-plot centrándonos en los precios de menos de 500\$.

```{r}
Airbnb_Data |> filter(log_price < 500) |> 
  ggplot(aes(x = city, y = log_price)) +  
  geom_boxplot() +  
  theme_bw() +  
  labs(title = "Precio por Ciudad")  
```

Podemos ver con más claridad como los precios más caros nos los encontramos en San Francisco y los más baratos en Los Ángeles y Chicago.

## Conclusión

Tras el análisis de los datos, hemos llegado a las siguientes conclusiones:

El objetivo principal de este estudio era analizar cómo varía el precio de las ofertas de Airbnb según las diferentes variables del conjunto de datos. Sin embargo, concluimos que la mayoría de las variables que podrían haber sido relevantes, presentan un coeficiente de correlación lineal bajo, lo que dificulta su análisis y limita la obtención de resultados significativos.

En el análisis univariante, se descartaron algunas variables debido a su escasa relevancia o la falta de información suficiente en ellas. Además, para el análisis bivariante, el tipo de propiedad quizás hubiera influenciado en el precio, no obstante, después de analizar la variable de forma univariante, concluimos que para que el bajo número de diferentes propiedades a parte de las 2 principales, no sería de gran relevancia para el análisis.

A pesar de ello, se identificaron varias variables con una buena correlación lineal entre sí. Se pudo concluir que, efectivamente, el precio aumenta según aumenta la gente que pueda alojarse en la propiedad y según aumenta el tamaño de la misma, cosa que parece ser importante a la hora de reservar en esta plataforma.

Cabe destacar que el estudio se ha visto ligeramente afectado negativamente debido a que, al haber tantas respuestas, hay una gran variedad en los datos, lo que ha impactado en la calidad de los resultados obtenidos, pero que aun así se han logrado obtener unas conclusiones válidas para el estudio.
