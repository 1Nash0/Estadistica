---
title: "Análisis AIRBNB"
author: "Grupo 12"
date: "2024-10-06"
output: html_document
---

```{r setup, include=FALSE, purl=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      eval = TRUE, 
                      warning = FALSE,
                      message = FALSE,
                      error = TRUE)
```

## Introducción y definición de objetivos

Durante estos últimos años, plataformas donde se reservan propiedades durante un tiempo determinado, como es Airbnb, ha ido subiendo su popularidad y mucha gente opta por este tipo de servicio. Es por ello que un análisis de este modelo de negocio es interesante tanto para los clientes como para la empresa propietaria de Airbnb. Por ello, el objetivo de esta investigación es observar como afecta el precio a las distintas variables.

Hemos descartado algunas variables dentro de esta base de datos. La primera es la variable bed_type, la cual descartamos ya que, tras hacer análisis previos, realmente no llevaría a cabo ningún cambio debido a que la gran mayoria son del mismo tipo (real bed). Las siguientes variables que hemos descartado son la de "latitud", "longitud" y "zipcode", ya que tienen que ver con la localización de la propiedad y eso ya se refleja con las variables "city" y "neighbourhood". Otra variable descartada es "amenities" ya que aparecerían muchas más variables que complejizarían el análisis y no aportaria a los objetivos propuestos. Con la variable "accomodates", la cual se refiere al número de personas que se permite en la propiedad, se descartó ya que no influiría en un cambio significativo en las dems variables, como por ejemplo la del precio, ya que sean las personas que sean el precio por habitación será el mismo. Además que con la información del número de camas se puede aproximar. La variable "host_response_rate" (la tasa de respuesta del anfitrión) la descartamos ya que en muchos de los casos no hay información. Las variables como "first review" (fecha en que se realizó la primera valoración), "last review" (fecha en que se realizó la última valoración), "description" (la descripcion), "host_has_profile_pic" (si el anfitrión tiene foto de perfil en Airbnb), "host_since" (fecha cuando se publicó por primera vez la propiedad), "name" (nombre de la propiedad) o "thumbnail_url" (URL de la página de la habitación) las hemos descartado porque no son relevantes para nuestro análisis o directamente no se pueden analizar.

## Importacion de datos y paquetes usados

```{r message=FALSE, warning=FALSE}
library(dplyr)
library(readr)
library(tidyverse)
library(ggplot2)
library(summarytools)
library(GGally)
library(knitr)
library(ggcorrplot)
library(corrplot)
library(htmltools)

Airbnb_Data <- read_csv("Airbnb_Data.csv")
```

## Diccionario de datos

-   `price` : Precio de la reserva de AIRBNB

    -   Tipo: Numérica continua

-   `property_type`: Tipo de propiedad que se reserva

    -   Tipo: Categórica multinivel

-   `room_type`: Tipo de habitación que incluye la reserva

    -   Tipo: Categórica multinivel

-   `bathrooms`: Número de baños que contiene la propiedad

    -   Tipo: Numérica continua

-   `cancellation_policy`: Si tiene política de cancelacion o no

    -   Tipo: Categórica ordinal

-   `cleaning_fee`: Si hay tarifa por limpieza

    -   Tipo: Categórica dicotómica (TRUE, hay/FALSE, no hay)

-   `city`: Ciudad donde se ubica la propiedad

    -   Tipo: Categórica multinivel

-   `neighbourhood`: Barrio donde se ubica la propiedad

    -   Tipo: Categórica multinivel

-   `host_identity_verified`: Si el anfitrión está verificado en Airbnb

    -   Tipo: Categórica dicotómica (TRUE, si/FALSE, no)

-   `instant_bookable`: Si se puede reservar la propiedad al instante

    -   Tipo: Categórica dicotómica (TRUE, si/FALSE, no)

-   `number_of_reviews`: Número de valoraciones de la propiedad

    -   Tipo: Numérica discreta

-   `review_scores_rating`: Puntuación general de las valoraciones de la propiedad

    -   Tipo: Numérica discreta

-   `bedrooms`: Número de habitaciones de la propiedad

    -   Tipo: Numérica discreta

-   `beds`: Número de camas de la propiedad

    -   Tipo: Numérica discreta

-   `bed_type`: Tipo de cama que ofrece la propiedad

    -   Tipo: Categórica multinivel

## Análisis exploratorio de datos

Vamos a realizar el estudio de todas las variables de los datos. Vamos a dividir el estudio en dos partes: análisis univariante y análisis bivariante.

### Análisis univariante:

#### Estudio de la variable price

Antes de estudiar la variable price, observamos que esta variable se encuentra de forma logarítmica, por tanto, no nos viene bien para el análisis. Simplemente invertiremos el logaritmo para obtener precios con más sentido.

```{r CambioPrice}
Airbnb_Data$log_price = exp(Airbnb_Data$log_price)
```

Ahora sí que realizaremos el análisis de price.

CONTAR EL NÚMERO DE RESPUESTAS

```{r NumRespuestasPrice, echo=TRUE}
num_respuestas_PRICE <- length(unique(Airbnb_Data$log_price))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_PRICE)
```

HISTOGRAMA DE PRECIOS

```{r HistoPrice}
hist(Airbnb_Data$log_price, col = "#CB0019", main = "Histograma de Precio", xlab = "Price", ylab = "Frecuencia", border = "black")
```

RESUMEN DE PRECIOS

```{r ResumenPrice}
Airbnb_Data |> select(log_price) |> descr() |> kable(digits = 2)
```

#### Estudio de la variable property_type

CONTAR EL NÚMERO DE RESPUESTAS

```{r}
num_respuestas_TYPE <- length(unique(Airbnb_Data$property_type))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_TYPE)
```

Como podemos observar, aquí si tiene sentido realizar un estudio para poder ver que tipo de casa es la que más se oferta

TABLA DE FRECUENCIAS

```{r}
tabla_frecuencias_type <- Airbnb_Data |>
     count(property_type) |>
    mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))

tabla_frecuencias_ordenada3 <- tabla_frecuencias_type |>
    arrange(desc(n))

tabla_frecuencias_ordenada3$F <- cumsum(tabla_frecuencias_ordenada3$f)

tabla_frecuencias_ordenada3$N <- cumsum(tabla_frecuencias_ordenada3$n)

print(tabla_frecuencias_ordenada3)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA DE PROPERTY_TYPE

```{r}
Airbnb_Data |> group_by(property_type) |> summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), property_type = reorder(property_type, -Frequency)) |> ggplot(aes(x = property_type, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de property_type", x = "Tipo de casa", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0017") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Esta gráfica nos permite ver con claridad cuáles son los tipos de propiedad que más se ofertan en Airbnb, como podemos observar la mayor parte de las ofertas son de apartamentos con el 66,1% del total, seguido de las casas particulares con un 22,3% y ya con mucha diferencia están los condiminios con un 3,59% del total y el resto de tipos de propiedades que suman entre sí un 5,7%.

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA DE PROPERTY_TYPE

```{r}
Airbnb_Data |>
     group_by(property_type) |>
     summarise(Frequency = n()) |>
     mutate(property_type = reorder(property_type, -Frequency)) |>
    ggplot(aes(x = property_type, y = Frequency)) +
     geom_bar(stat = "identity", aes(fill = Frequency)) +
     theme_bw() +
     labs(title = "Gráfico de barras con frecuencia absoluta de property_type",
          x = "Tipo de casa",
          y = "Frecuencia absoluta") +
     scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0017") +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Estudio de la variable room_type

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_TYPE <- length(unique(Airbnb_Data$room_type))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_TYPE)
```

FRECUENCIAS RELATIVAS Y ABSOLUTAS

```{r}
tabla_frecuencias_type <- Airbnb_Data |>
     count(room_type) |>
    mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
 tabla_frecuencias_ordenada3 <- tabla_frecuencias_type |>
    arrange(desc(n))
 tabla_frecuencias_ordenada3$F <- cumsum(tabla_frecuencias_ordenada3$f)
 tabla_frecuencias_ordenada3$N <- cumsum(tabla_frecuencias_ordenada3$n)
 print(tabla_frecuencias_ordenada3)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA DE ROOM_TYPE

```{r}
Airbnb_Data |>
     group_by(room_type) |>
     summarise(Frequency = n()) |>
     mutate(room_type = reorder(room_type, -Frequency)) |>
     ggplot(aes(x = room_type, y = Frequency)) +
     geom_bar(stat = "identity", aes(fill = Frequency)) +
     theme_bw() +
     labs(title = "Gráfico de barras con frecuencia absoluta de room_type",
          x = "Tipo de habitación",
          y = "Frecuencia absoluta") +
     scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0017") +
     theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA DE ROOM_TYPE

```{r}
Airbnb_Data |>
     group_by(room_type) |>
     summarise(Frequency = n()) |>
     mutate(room_type = reorder(room_type, -Frequency)) |>
     ggplot(aes(x = room_type, y = Frequency)) +
     geom_bar(stat = "identity", aes(fill = Frequency)) +
     theme_bw() +
     labs(title = "Gráfico de barras con frecuencia absoluta de room_type",
          x = "Tipo de habitación",
          y = "Frecuencia absoluta") +
     scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0017") +
     theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Estudio de la variable bathrooms

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_Bathrooms <- length(unique(Airbnb_Data$bathrooms))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_Bathrooms)

```

FRECUENCIAS RELATIVAS Y ABSOLUTAS

```{r}
tabla_frecuencias_bathrooms <- Airbnb_Data |>
     count(bathrooms) |>
     mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
 tabla_frecuencias_ordenada4 <- tabla_frecuencias_bathrooms |> 
     arrange(desc(n))
 tabla_frecuencias_ordenada4$F <- cumsum(tabla_frecuencias_ordenada4$f)
 tabla_frecuencias_ordenada4$N <- cumsum(tabla_frecuencias_ordenada4$n)
 print(tabla_frecuencias_ordenada4) 
```

HISTOGRAMA SEGÚN NÚMERO DE BAÑOS

```{r}
datos <- Airbnb_Data$bathrooms
ggplot(data.frame(x = datos), aes(x = x)) +
     geom_histogram(binwidth = 1, fill = "#CB0017", color = "black", 
                    aes(y = ..density..), alpha = 0.6) +
     stat_function(fun = dnorm, args = list(mean = mean(datos),  sd = sd(datos)), color = "#CB0019", size = 1.5) +
     labs(title = "Distribución del Número de Baños",
         x = "Número de Baños",
         y = "Frecuencia") 
```

ANÁLISIS NÚMERICO

```{r}
Airbnb_Data |> select(bathrooms) |> descr() |> kable(digits = 2)
```

#### Estudio de la variable bed_type

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_bed_type <- length(unique(Airbnb_Data$bed_type))
cat("El número de respuestas obtenido es: ", num_respuestas_bed_type)
```

TABLA DE FRECUENCIAS

```{r}
tabla_frec_bed_type <- Airbnb_Data |> count(bed_type) |> mutate (f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_5 <- tabla_frec_bed_type |> arrange(desc(n)) 
tabla_frec_ord_5$N <- cumsum(tabla_frec_ord_5$n)
tabla_frec_ord_5$F <- cumsum(tabla_frec_ord_5$f) 
print(tabla_frec_ord_5)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(bed_type) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), bed_type = reorder(bed_type, -Frequency)) |> ggplot(aes(x = bed_type, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de bed_type", x = "Tipo de cama", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "red") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA

```{r}
Airbnb_Data  |> group_by(bed_type) |>  summarise(Frequency = n()) |> mutate(bed_type = reorder(bed_type, -Frequency)) |> ggplot(aes(x = bed_type, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de bed_type", x = "Tipo de cama", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0017") + theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

#### Estudio de la variable cancellation_policy

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_cancellation_policy <- length(unique(Airbnb_Data$cancellation_policy)) 
cat("El número de respuestas es: ", num_respuestas_cancellation_policy)
```

FRECUENCIAS RELATIVAS Y ABSOLUTAS

```{r}
tabla_frec_cancellation_policy <- Airbnb_Data |> count(cancellation_policy) |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_6 <- tabla_frec_bed_type |> arrange(desc(n)) 
tabla_frec_ord_6$N <- cumsum(tabla_frec_ord_6$n)
tabla_frec_ord_6$F <- cumsum(tabla_frec_ord_6$f) 
print(tabla_frec_cancellation_policy)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(cancellation_policy) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), cancellation_policy = reorder(cancellation_policy, -Frequency)) |> ggplot(aes(x = cancellation_policy, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de cancellation_policy", x = "Cancelación de póliza", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA

```{r}
Airbnb_Data  |> group_by(cancellation_policy) |>  summarise(Frequency = n()) |> mutate(cancellation_policy = reorder(cancellation_policy, -Frequency)) |> ggplot(aes(x = cancellation_policy, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de cancellation_policy", x = "Cancelación de póliza", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Estudio de la variable cleaning_fee

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_cleaning_fee <- length(unique(Airbnb_Data$cleaning_fee))
cat("El número de respuestas obtenido es: ", num_respuestas_cleaning_fee)
```

FRECUENCIAS RELATIVAS Y ABSOLUTAS

```{r}
tabla_frec_cleaning_fee <- Airbnb_Data |> count(cleaning_fee) |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_7 <- tabla_frec_cleaning_fee |> arrange(desc(n)) 
tabla_frec_ord_7$N <- cumsum(tabla_frec_ord_7$n)
tabla_frec_ord_7$F <- cumsum(tabla_frec_ord_7$f) 
print(tabla_frec_cleaning_fee)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(cleaning_fee) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), cleaning_fee = reorder(cleaning_fee, -Frequency)) |> ggplot(aes(x = cleaning_fee, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de cleaning_fee", x = "Impuesto de Limpieza", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA

```{r}
Airbnb_Data  |> group_by(cleaning_fee) |>  summarise(Frequency = n()) |> mutate(cleaning_fee = reorder(cleaning_fee, -Frequency)) |> ggplot(aes(x = cleaning_fee, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de cleaning_fee", x = "Impuesto de Liempieza", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Estudio de la variable city

CONTAR EL NUMERO DE RESPUESTAS

num_respuestas_city \<- length(unique(Airbnb_Data\$city))

cat("El número de respuestas obtenido es: ", num_respuestas_city)

```{r}
num_respuestas_city <- length(unique(Airbnb_Data$city))
cat("El número de respuestas obtenido es: ", num_respuestas_city)
```

FRECUENCIAS RELATIVAS Y ABSOLUTAS

```{r}
tabla_frec_city <- Airbnb_Data |> count(city) |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_8 <- tabla_frec_city |> arrange(desc(n)) 
tabla_frec_ord_8$N <- cumsum(tabla_frec_ord_8$n)
tabla_frec_ord_8$F <- cumsum(tabla_frec_ord_8$f) 
print(tabla_frec_cleaning_fee)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(city) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), city = reorder(city, -Frequency)) |> ggplot(aes(x = city, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de city", x = "Ciudad", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA

```{r}
Airbnb_Data  |> group_by(city) |>  summarise(Frequency = n()) |> mutate(city = reorder(city, -Frequency)) |> ggplot(aes(x = city, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de city", x = "Ciudades", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Estudio de la variable host_identity_verified

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_host_identity_verified <- length(unique(Airbnb_Data$host_identity_verified))
cat("El número de respuestas obtenido es: ", num_respuestas_host_identity_verified)
```

FRECUENCIAS RELATIVAS Y ABSOLUTAS

```{r}
tabla_frec_host_identity_verified <- Airbnb_Data |> count(Airbnb_Data$host_identity_verified) |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_8 <- tabla_frec_host_identity_verified |> arrange(desc(n)) 
tabla_frec_ord_8$N <- cumsum(tabla_frec_ord_8$n)
tabla_frec_ord_8$F <- cumsum(tabla_frec_ord_8$f) 
print(tabla_frec_host_identity_verified)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(host_identity_verified) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), host_identity_verified = reorder(host_identity_verified, -Frequency)) |> ggplot(aes(x = host_identity_verified, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de host_identity_verified", x = "¿Está verificado?", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA

```{r}
Airbnb_Data  |> group_by(host_identity_verified) |>  summarise(Frequency = n()) |> mutate(host_identity_verified = reorder(host_identity_verified, -Frequency)) |> ggplot(aes(x = host_identity_verified, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de host_identity_verified", x = "Identidad verfificada", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Estudio de la variable instant_bookable

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_instant_bookable <- length(unique(Airbnb_Data$instant_bookable))
cat("El número de respuestas obtenido es: ", num_respuestas_instant_bookable)
```

TABLA DE FRECUENCIAS

```{r}
tabla_frec_instant_bookable <- Airbnb_Data |> count(Airbnb_Data$instant_bookable) |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_8 <- tabla_frec_instant_bookable |> arrange(desc(n)) 
tabla_frec_ord_8$N <- cumsum(tabla_frec_ord_8$n)
tabla_frec_ord_8$F <- cumsum(tabla_frec_ord_8$f) 
print(tabla_frec_instant_bookable)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(instant_bookable) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), instant_bookable = reorder(instant_bookable, -Frequency)) |> ggplot(aes(x = instant_bookable, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de instant_bookable", x = "¿Se puede reservar al instante?", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA

```{r}
Airbnb_Data  |> group_by(instant_bookable) |>  summarise(Frequency = n()) |> mutate(instant_bookable = reorder(instant_bookable, -Frequency)) |> ggplot(aes(x = instant_bookable, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de instant_bookable", x = "Reserva instantánea", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Estudio de la variable neighbourhood

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_neighbourhood <- length(unique(Airbnb_Data$neighbourhood))
cat("El número de respuestas obtenido es: ", num_respuestas_neighbourhood)
```

TABLA DE FRECUENCIAS

```{r}
tabla_frec_neighbourhood <- Airbnb_Data |> count(Airbnb_Data$neighbourhood) |> mutate(f = n/nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
tabla_frec_ord_1 <- tabla_frec_neighbourhood |> arrange(desc(n)) 
tabla_frec_ord_1$N <- cumsum(tabla_frec_ord_8$n)
tabla_frec_ord_1$F <- cumsum(tabla_frec_ord_8$f) 
print(tabla_frec_neighbourhood)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(neighbourhood) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), neighbourhood = reorder(neighbourhood, -Frequency)) |> ggplot(aes(x = neighbourhood, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de neighbourhood", x = "Barrio", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(neighbourhood) |>  summarise(Frequency = n()) |> mutate(neighbourhood = reorder(neighbourhood, -Frequency)) |> ggplot(aes(x = neighbourhood, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de neighbourhood", x = "Barrios", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0019") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Después de ver la tabla de frecuencias y el histograma, decidimos que al haber tantos valores no merece la pena estudiarlos de manera univariante ya que no se puede apreciar correctamente.

#### Estudio de la variable number_of_reviews

CONTAR EL NÚMERO DE RESPUESTAS

```{r NumRespuestasnumber_of_reviews, echo=TRUE}
num_respuestas_number_of_reviews <- length(unique(Airbnb_Data$number_of_reviews))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_number_of_reviews)
```

HISTOGRAMA DE NÚMERO DE REVIEWS

```{r Histonumber_of_reviews}
hist(Airbnb_Data$number_of_reviews, col = "#CB0019", main = "Histograma de Número de Reviews", xlab = "number_of_reviews", ylab = "Frecuencia", border = "black")
```

RESUMEN DE PRECIOS

```{r Resumennumber_of_reviews}
Airbnb_Data |> select(number_of_reviews) |> descr() |> kable(digits = 2)
```

#### Estudio de la variable review_scores_rating

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_review_scores_rating <- length(unique (Airbnb_Data$review_scores_rating))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_review_scores_rating)
```

FRECUENCIAS RELATIVAS Y ABSOLUTAS

```{r}

```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}


```

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA

```{r}

```

#### Estudio de la variable bedrooms

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_neighbourhood <- length(unique(Airbnb_Data$neighbourhood))
cat("El número de respuestas obtenido es: ", num_respuestas_neighbourhood)
```

FRECUENCIAS RELATIVAS Y ABSOLUTAS

```{r}
tabla_frecuencias_beds <- Airbnb_Data |>                   
     count(beds) |>
     mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
 tabla_frecuencias_ordenada4 <- tabla_frecuencias_beds |> 
     arrange(desc(n))
 tabla_frecuencias_ordenada4$F <- cumsum(tabla_frecuencias_ordenada4$f)
 tabla_frecuencias_ordenada4$N <- cumsum(tabla_frecuencias_ordenada4$n)
 print(tabla_frecuencias_ordenada4)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(bedrooms) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), bedrooms = reorder(bedrooms, -Frequency)) |> ggplot(aes(x = bedrooms, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de habitaciones", x = "Número de habitaciones", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "#CB0017", high = "#CB0017") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA

```{r}
datos <- Airbnb_Data$beds                                    
 ggplot(data.frame(x = datos), aes(x = x)) +
     geom_histogram(binwidth = 1, fill = "#CB0017", color = "black", 
                    aes(y = ..density..), alpha = 0.6) +
     stat_function(fun = dnorm, args = list(mean = mean(datos), 
                                            sd = sd(datos)), color = "#CB0017", size = 1.5) +
     labs(title = "Distribución del Número de Habitaciones",
          x = "Número de Habitaciones",
          y = "Frecuencia") 
```

ANÁLISIS NUMERICO

```{r}
Airbnb_Data |> select(beds) |> descr() |> kable(digits = 2) 
```

#### Estudio de la variable beds

CONTAR EL NUMERO DE RESPUESTAS

```{r}
num_respuestas_BEDS <- length(unique(Airbnb_Data$beds))     
cat("La cantidad de respuestas obtenidas es:", num_respuestas_BEDS)
```

FRECUENCIAS RELATIVAS Y ABSOLUTAS

```{r}
tabla_frecuencias_beds <- Airbnb_Data |>                   
     count(beds) |>
     mutate(f = n / nrow(Airbnb_Data), N = cumsum(n), F = cumsum(f))
 tabla_frecuencias_ordenada4 <- tabla_frecuencias_beds |> 
     arrange(desc(n))
 tabla_frecuencias_ordenada4$F <- cumsum(tabla_frecuencias_ordenada4$f)
 tabla_frecuencias_ordenada4$N <- cumsum(tabla_frecuencias_ordenada4$n)
 print(tabla_frecuencias_ordenada4)
```

GRAFICO DE BARRAS CON FRECUENCIA RELATIVA

```{r}
Airbnb_Data  |> group_by(beds) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), beds = reorder(beds, -Frequency)) |> ggplot(aes(x = beds, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de camas", x = "Número de camas", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "#CB0017") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

GRAFICO DE BARRAS CON FRECUENCIA ABSOLUTA

```{r}
datos <- Airbnb_Data$beds  
 ggplot(data.frame(x = datos), aes(x = x)) +
     geom_histogram(binwidth = 1, fill = "skyblue", color = "black", 
                    aes(y = ..density..), alpha = 0.6) +
     stat_function(fun = dnorm, args = list(mean = mean(datos), 
                                            sd = sd(datos)), color = "#CB0019", size = 1.5) +
     labs(title = "Distribución del Número de Habitaciones",
          x = "Número de Habitaciones",
          y = "Frecuencia") 
```

ANÁLISIS NÚMERICO

```{r}
Airbnb_Data |> select(beds) |> descr() |> kable(digits = 2)
```

### Análisis bivariante:

#### Estudio de las variables bedrooms y price

GRÁFICO DE DISPERSIÓN CON AJUSTE DE REGRESIÓN

```{r}
Airbnb_Data |>
    ggplot(aes(x = bedrooms, y = log_price)) +
    geom_point() +
    geom_smooth() +
    labs(title = "Gráfico de dispersión con ajuste de regresión")
```

GRÁFICO DE DISPERSIÓN IDENTIFICANDO POR LOCALIDAD

Aquí añadimos la variable city:

```{r}
Airbnb_Data |> 
    ggplot(aes(x = bedrooms, y = log_price, col = city)) +
    geom_point() +
    labs(title = "Gráfico de dispersión identificando por localidad ")
```

#### Estudio de las variables bedrooms, bathrooms, price y beds

MATRIZ DE CORRELACIÓN

```{r}
Airbnb_Data |> select(bedrooms, bathrooms, log_price, beds) |> 
    drop_na() |>  
    cor() |> 
    round(2)
```

GRÁFICO DE CORRELACIÓN NUMÉRICA

```{r}
Airbnb_Data |> 
    select(bedrooms, bathrooms, log_price, beds) |>
    drop_na() |> 
    cor() |> 
    round(2) |>
    corrplot(method = "ellipse",  type = "lower",      addCoef.col = "#CB0017", diag = FALSE)
```

#### Estudio de las variables price y ciudad

HISTOGRAMA DE PRECIO POR CIUDAD

```{r}
ggplot(Airbnb_Data, aes(x = log_price, fill = city)) +
    
    geom_histogram(
        bins = 15, 
        alpha = 0.7,  
        position = 'identity'  
    ) +
    
    labs(
        title = "Histograma de Precio por Ciudad", 
        x = "Price", 
        y = "Frecuencia"
    ) +
   
    theme_bw() +

    guides(fill=guide_legend(title="Tipo"))
```

Este histograma nos permite ver con claridad cómo los precios más caros se encuentran en Washington DC, aunque la mayor parte de las ofertas se encuentran en Nueva York y Los Ángeles

GRÁFICO RESUMEN

```{r fig.height=5, fig.width=10}
##ggpairs(
 
##  Airbnb_Data |> select(log_price, bedrooms, bathrooms, beds, bed_type),
  
##  aes(col = bed_type)
##)
```

#### Estudio de las variables bedrooms y bathrooms

```{r}
Airbnb_Data |> 
    ggplot(aes(x = bedrooms, y = bathrooms)) +
    geom_point() +
    geom_smooth() +
    labs(title = "Gráfico de dispersión con ajuste de regresión")
```

## Conclusión

Tras este analisis de los datos propuestos, podemos llegar a estas conclusiones:
